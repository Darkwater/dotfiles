#!/usr/bin/zsh

killall -USR1 dunst

if [[ "$1" = "prompt" ]]; then
    echo -n | dmenu -i -f -p 'reason:'                 \
          -fn 'Droid Sans Mono-10'                     \
          -q                                           \
          -x 500 -y 500                                \
          -w 920 -h 24                                 \
          -nb '#1d1f21' -nf '#ababab'                  \
          -sb '#111111' -sf '#ffaf00'                  > /tmp/afk.reason
elif [[ $# -ge 1 ]]; then
    echo $* > /tmp/afk.reason
else
    echo > /tmp/afk.reason
fi

sleep 0.2s

maim /tmp/screenshot.png && 
convert /tmp/screenshot.png -level 0,100%,1.5 -blur 0x8 -spread 10 /tmp/screenshot.png &&
zsh -c 'i3lock -ni /tmp/screenshot.png; killall conky; killall -USR2 dunst' &

sleep 0.2s
conky &

xdotool key a Escape
